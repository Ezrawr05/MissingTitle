<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing Title</title>

    <!-- Icon -->
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jacquarda+Bastarda+9&family=Jersey+10&family=Micro+5&display=swap" rel="stylesheet">

    <!-- Link to CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="home"> <!-- Add the "home" class for the menu page -->`
    
    <!-- Background Music -->
    <audio id="background-music" autoplay loop>
        <source src="sounds/background.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Title Section -->
    <header id="title-section">
        <h1>Missing Title</h1>
    </header>

    <!-- Welcome Section -->
    <section id="welcome-section">
        <div class="content">
            <!-- TV Image -->
            <img src="images/TV.png" alt="TV Image" class="tv-element">
        
            <!-- Welcome Text -->
            <p class="welcome-text">Welcome player...</p>
        
            <!-- Text for TV Screen -->
            <p class="tv-text">you might feel a<br>lurking presence...<br>begin?</p>
        
            <!-- Start Button -->
            <button onclick="startStory()">
                <img src="images/button-up.png" alt="Start Button">
            </button>
        </div>
    </section>

    <!-- Storyline Section -->
    <section id="story-section" style="display: none;">
        <div class="content">
            <p class="story-text story-text-1">How are you today?</p>
            <p class="story-text story-text-2">No really<br>how are you?</p>
            <p class="story-text story-text-3">What's been weighing on your mind?<br>Heavy, isn't it?</p>
            <p class="story-text story-text-4">Do you<br>feel it?<br>The shadow<br>behind you.</p>
            <p class="story-text story-text-5">Why do you look so sad?</p>
            <p class="story-text story-text-6">Oh<br>dont worry...<br>I already<br>know why</p>
            <p class="story-text story-text-7">But let's not dwell on that</p>
            <p class="story-text story-text-8">Let's do something fun instead</p>
            <p class="story-text story-text-9">Let's play a game!</p>
            
            <!-- New Button Below the Last Text -->
            <button onclick="startGame()">
                <img src="images/playbuttonup.png" alt="Play Button">
            </button>
        </div>
    </section>

    <!-- Game Section -->
    <section id="game-section" style="display: none;">
        <div class="content">
            <!-- Game Loading Message -->
            <p>This is where the game should open, please visit this link to play<br>https://ezrawr05.github.io/missingtitlegame/</p>
            <p>Return to this Tab after finishing the game. Scroll down and click Game Over to navigate to next page.</p>
            <div id="unity-container" style="width: 100%; height: 600px;">
             <object id="UnityObject" classid="clsid:444785F1-DE89-4295-863A-D46C3A781394"
        width="420" height="750"
        codebase="http://webplayer.unity3d.com/download_webplayer/UnityWebPlayer.cab#version=2,0,0,0">
 <param name="unity3d" value="WebPlayer.unity3d" />
 <embed id="UnityEmbed" src="MissingTitleFinal/game.html" width="600" height="900"
  type="application/vnd.unity" pluginspage="http://www.unity3d.com/unity-web-player-2.x" />
 </object>
            </div>
            
            <button onclick="showLossPage()">Game over</button> <!-- Button to go to the loss page -->
        </div>
    </section>

    <!-- Loss Page Section -->
    <section id="loss-page" style="display: none;">
        <div class="content">
            <p class="loss-text loss-text-1">Good game! You did it! You defeated the monster and won! Scroll down to collect your prize :)</p>
            <p class="loss-text loss-text-2">Did you actually think you've won?</p>
            <p class="loss-text loss-text-3">You can still<br>feel me.</p>
            <p class="loss-text loss-text-4">See?</p>
            <p class="loss-text loss-text-5">You really thought you could out run me?</p>
            <p class="loss-text loss-text-6">No matter how many shadows you silence...</p>
            <p class="loss-text loss-text-7">I will always be here...</p>
            <p class="loss-text loss-text-8">Watching.</p>
            <p class="loss-text loss-text-9">Waiting.</p>
            <p class="loss-text loss-text-10">You're not a hero. You're exactly what you are. And that will never be good enough.</p>
        </div>
    </section>

    <!-- Link to JavaScript -->
    <script src="script.js"></script>

    <!-- Unity Game Script Initialization-->
    <script>
        window.onload = function() {
            var unityContainer = document.querySelector("#unity-container");

            // Dynamically load the Unity loader script
            var script = document.createElement('script');
            script.src = "/MissingTitleXamp/MissingTitleFinal/Build/MissingTitleFinal.loader.js"; // Ensure correct path
            script.onload = function() {
                // Check if UnityLoader is now defined
                if (typeof UnityLoader !== "undefined") {
                    // Unity is available, instantiate the game
                    UnityLoader.instantiate("unity-container", "MissingTitleFinal/Build", {
                        onProgress: function(gameInstance, progress) {
                            console.log("Loading progress: " + progress);
                        },
                        onError: function(error) {
                            console.error("Error loading Unity game:", error);
                        }
                    });
                } else {
                    console.error("UnityLoader is not defined!");
                }
            };
            script.onerror = function() {
                console.error("Error loading Unity loader script.");
            };
            document.body.appendChild(script);
        };
    </script>

</body>
</html>